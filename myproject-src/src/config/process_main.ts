import { t } from '@/utils/lang'
export const fast_lineart = ({
  client_id,
  load_img,
  style_img,
  text,
  negative,
  ip_adapter_name,
  ip_adapter_strength,
  ckpt,
  lora_name,
  lora_strength,
  lora_clip,
  step,
  cfg,
  sampler_name,
  hd,
  controlnet_strength,
  controlnet_clip,
  controlnet_name,
  line_strength,
}: any) => {
  const input_seed = Math.floor(Math.random() * 1000000000000);
  const prompt = text.replaceAll('，', ',');
  const negative_prompt = negative.replaceAll('，', ',');
  console.log('fast_lineart', {
    client_id,
    load_img,
    style_img,
    text,
    negative,
    ip_adapter_name,
    ip_adapter_strength,
    ckpt,
    lora_name,
    lora_strength,
    lora_clip,
    step,
    cfg,
    sampler_name,
    hd,
    controlnet_strength,
    controlnet_clip,
    controlnet_name,
    input_seed,
    prompt,
    negative_prompt,
    line_strength,
  });
  return {
    client_id: client_id,
    prompt: {
      '1': {
        inputs: { ckpt_name: ckpt },
        class_type: 'CheckpointLoaderSimple',
      },
      '3': {
        inputs: { ipadapter_file: ip_adapter_name },
        class_type: 'IPAdapterModelLoader',
      },
      '4': { inputs: { clip_name: 'SD1.5\\pytorch_model.bin' }, class_type: 'CLIPVisionLoader' },
      '5': {
        inputs: {
          weight: ip_adapter_strength,
          noise: 0.1,
          weight_type: 'original',
          start_at: 0,
          end_at: 1,
          unfold_batch: false,
          ipadapter: ['3', 0],
          clip_vision: ['4', 0],
          image: ['6', 0],
          model: ['36', 0],
        },
        class_type: 'IPAdapterApply',
      },
      '6': { inputs: { image: style_img, upload: 'image' }, class_type: 'LoadImage' },
      '7': {
        inputs: {
          text: prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '8': {
        inputs: {
          text: negative_prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '9': {
        inputs: {
          seed: input_seed,
          steps: step,
          cfg: cfg,
          sampler_name: sampler_name,
          scheduler: 'normal',
          denoise: 0.9500000000000001,
          model: ['5', 0],
          positive: ['51', 0],
          negative: ['51', 1],
          latent_image: ['19', 0],
        },
        class_type: 'KSampler',
      },
      '11': { inputs: { samples: ['9', 0], vae: ['40', 0] }, class_type: 'VAEDecode' },
      '14': { inputs: { image: load_img, upload: 'image' }, class_type: 'LoadImage' },
      '15': {
        inputs: { control_net_name: controlnet_name },
        class_type: 'ControlNetLoader',
      },
      '18': {
        inputs: {
          lora_name: 'lcm-lora-sdv1-5.safetensors',
          strength_model: 1,
          strength_clip: 1,
          model: ['1', 0],
          clip: ['1', 1],
        },
        class_type: 'LoraLoader',
      },
      '19': { inputs: { pixels: ['39', 0], vae: ['1', 2] }, class_type: 'VAEEncode' },
      '28': { inputs: { filename_prefix: 'Eva_HD', images: ['37', 0] }, class_type: 'SaveImage' },
      '36': {
        inputs: {
          lora_name: lora_name ?? 'lcm-lora-sdv1-5.safetensors',
          strength_model: lora_name ? lora_strength : 0,
          strength_clip: lora_name ? lora_clip : 0,
          model: ['18', 0],
          clip: ['18', 1],
        },
        class_type: 'LoraLoader',
      },
      '37': {
        inputs: {
          upscale_model: '8x_eva_super.pth',
          mode: 'rescale',
          rescale_factor: hd,
          resize_width: 1024,
          resampling_method: 'lanczos',
          supersample: 'false',
          rounding_modulus: 8,
          image: ['11', 0],
        },
        class_type: 'CR Upscale Image',
      },
      '39': {
        inputs: { coarse: 'enable', resolution: line_strength, image: ['14', 0] },
        class_type: 'LineArtPreprocessor',
      },
      '40': {
        inputs: { vae_name: '真实感vae-ft-mse-840000-ema-pruned_v10.0.pt' },
        class_type: 'VAELoader',
      },
      '51': {
        inputs: {
          strength: controlnet_strength,
          start_percent: 0,
          end_percent: controlnet_clip,
          positive: ['7', 0],
          negative: ['8', 0],
          control_net: ['15', 0],
          image: ['39', 0],
        },
        class_type: 'ControlNetApplyAdvanced',
      },
      '52': { inputs: { images: ['39', 0] }, class_type: 'PreviewImage' },
      '54': {
        inputs: { low_threshold: 0.4, high_threshold: 0.8, image: ['14', 0] },
        class_type: 'Canny',
      },
      '55': {
        inputs: {
          score_threshold: 0.1,
          dist_threshold: 0.1,
          resolution: line_strength,
          image: ['14', 0],
        },
        class_type: 'M-LSDPreprocessor',
      },
      '61': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'Zoe-DepthMapPreprocessor',
      },
      '63': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'OneFormer-COCO-SemSegPreprocessor',
      },
    },
    extra_data: {
      extra_pnginfo: {
        workflow: {
          last_node_id: 63,
          last_link_id: 150,
          nodes: [
            {
              id: 19,
              type: 'VAEEncode',
              pos: [955, 532],
              size: { '0': 210, '1': 46 },
              flags: {},
              order: 15,
              mode: 0,
              inputs: [
                { name: 'pixels', type: 'IMAGE', link: 150 },
                { name: 'vae', type: 'VAE', link: 28 },
              ],
              outputs: [{ name: 'LATENT', type: 'LATENT', links: [26], shape: 3 }],
              properties: { 'Node name for S&R': 'VAEEncode' },
            },
            {
              id: 11,
              type: 'VAEDecode',
              pos: [1300, 170],
              size: { '0': 140, '1': 50 },
              flags: {},
              order: 21,
              mode: 0,
              inputs: [
                { name: 'samples', type: 'LATENT', link: 11, label: 'Latent' },
                { name: 'vae', type: 'VAE', link: 81, label: 'VAE', slot_index: 1 },
              ],
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [13, 73],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
              ],
              properties: { 'Node name for S&R': 'VAEDecode' },
            },
            {
              id: 40,
              type: 'VAELoader',
              pos: [1242, 9],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 0,
              mode: 0,
              outputs: [{ name: 'VAE', type: 'VAE', links: [81], shape: 3 }],
              properties: { 'Node name for S&R': 'VAELoader' },
              widgets_values: ['真实感vae-ft-mse-840000-ema-pruned_v10.0.pt'],
            },
            {
              id: 4,
              type: 'CLIPVisionLoader',
              pos: [178, -39],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 1,
              mode: 0,
              outputs: [
                {
                  name: 'CLIP_VISION',
                  type: 'CLIP_VISION',
                  links: [2],
                  shape: 3,
                  slot_index: 0,
                  label: t('CLIP视觉'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPVisionLoader' },
              widgets_values: ['SD1.5\\pytorch_model.bin'],
            },
            {
              id: 1,
              type: 'CheckpointLoaderSimple',
              pos: [179, 74],
              size: { '0': 300, '1': 100 },
              flags: {},
              order: 2,
              mode: 0,
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [21],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
                { name: 'CLIP', type: 'CLIP', links: [22], shape: 3, slot_index: 1, label: 'CLIP' },
                { name: 'VAE', type: 'VAE', links: [28], shape: 3, label: 'VAE', slot_index: 2 },
              ],
              properties: { 'Node name for S&R': 'CheckpointLoaderSimple' },
              widgets_values: [ckpt],
            },
            {
              id: 3,
              type: 'IPAdapterModelLoader',
              pos: [181, -156],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 3,
              mode: 0,
              outputs: [
                {
                  name: 'IPADAPTER',
                  type: 'IPADAPTER',
                  links: [1],
                  shape: 3,
                  slot_index: 0,
                  label: t('IP适配'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterModelLoader' },
              widgets_values: [ip_adapter_name],
            },
            {
              id: 28,
              type: 'SaveImage',
              pos: [2436, 482],
              size: { '0': 1673.71728515625, '1': 1076.5091552734375 },
              flags: {},
              order: 24,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 74 }],
              properties: {},
              widgets_values: ['Eva_HD'],
            },
            {
              id: 9,
              type: 'KSampler',
              pos: [926, 167],
              size: { '0': 320.16607666015625, '1': 262 },
              flags: {},
              order: 20,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 7, label: t('模型') },
                { name: 'positive', type: 'CONDITIONING', link: 111, label: t('正面提示词') },
                { name: 'negative', type: 'CONDITIONING', link: 112, label: t('负面提示词') },
                { name: 'latent_image', type: 'LATENT', link: 26, label: 'Latent', slot_index: 3 },
              ],
              outputs: [
                {
                  name: 'LATENT',
                  type: 'LATENT',
                  links: [11],
                  shape: 3,
                  slot_index: 0,
                  label: 'Latent',
                },
              ],
              properties: { 'Node name for S&R': 'KSampler' },
              widgets_values: [
                input_seed,
                'randomize',
                step,
                cfg,
                sampler_name,
                'normal',
                0.9500000000000001,
              ],
            },
            {
              id: 6,
              type: 'LoadImage',
              pos: [941, 670],
              size: { '0': 453.823486328125, '1': 476.8275146484375 },
              flags: {},
              order: 4,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [3],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [style_img, 'image'],
            },
            {
              id: 8,
              type: 'CLIPTextEncode',
              pos: [650, 420],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 17,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 72, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [115],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [negative_prompt],
              color: '#322',
              bgcolor: '#533',
            },
            {
              id: 55,
              type: 'M-LSDPreprocessor',
              pos: [-183, 603],
              size: { '0': 315, '1': 106 },
              flags: {},
              order: 10,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 122 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'M-LSDPreprocessor' },
              widgets_values: [0.1, 0.1, line_strength],
            },
            {
              id: 54,
              type: 'Canny',
              pos: [-184, 769],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 9,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 119 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'Canny' },
              widgets_values: [0.4, 0.8],
            },
            {
              id: 61,
              type: 'Zoe-DepthMapPreprocessor',
              pos: [-185, 480],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 11,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 135 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'Zoe-DepthMapPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 14,
              type: 'LoadImage',
              pos: [-430, 1130],
              size: { '0': 666.5375366210938, '1': 772.7017822265625 },
              flags: {},
              order: 5,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [78, 119, 122, 135, 144],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [load_img, 'image'],
            },
            {
              id: 52,
              type: 'PreviewImage',
              pos: [319, 1129],
              size: { '0': 567.489990234375, '1': 477.95001220703125 },
              flags: {},
              order: 14,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 148 }],
              properties: { 'Node name for S&R': 'PreviewImage' },
            },
            {
              id: 63,
              type: 'OneFormer-COCO-SemSegPreprocessor',
              pos: [-181, 342],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 12,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 144 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'OneFormer-COCO-SemSegPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 36,
              type: 'LoraLoader',
              pos: [176, 430],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 13,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 106 },
                { name: 'clip', type: 'CLIP', link: 107 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [70], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [72, 86], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: [
                lora_name ?? 'lcm-lora-sdv1-5.safetensors',
                lora_name ? lora_strength : 0,
                lora_name ? lora_clip : 0,
              ],
            },
            {
              id: 18,
              type: 'LoraLoader',
              pos: [172, 232],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 7,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 21 },
                { name: 'clip', type: 'CLIP', link: 22 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [106], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [107], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: ['lcm-lora-sdv1-5.safetensors', 1, 1],
            },
            {
              id: 5,
              type: 'IPAdapterApply',
              pos: [649, -79],
              size: { '0': 210, '1': 258 },
              flags: {},
              order: 16,
              mode: 0,
              inputs: [
                { name: 'ipadapter', type: 'IPADAPTER', link: 1, label: t('IP适配') },
                { name: 'clip_vision', type: 'CLIP_VISION', link: 2, label: t('CLIP视觉') },
                { name: 'image', type: 'IMAGE', link: 3, label: t('图像') },
                { name: 'model', type: 'MODEL', link: 70, label: t('模型') },
                { name: 'attn_mask', type: 'MASK', link: null },
              ],
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [7],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterApply' },
              widgets_values: [ip_adapter_strength, 0.1, 'original', 0, 1, false],
            },
            {
              id: 7,
              type: 'CLIPTextEncode',
              pos: [650, 250],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 18,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 86, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [114],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [prompt],
              color: '#232',
              bgcolor: '#353',
            },
            {
              id: 51,
              type: 'ControlNetApplyAdvanced',
              pos: [561, 737],
              size: { '0': 315, '1': 166 },
              flags: {},
              order: 19,
              mode: 0,
              inputs: [
                { name: 'positive', type: 'CONDITIONING', link: 114 },
                { name: 'negative', type: 'CONDITIONING', link: 115 },
                { name: 'control_net', type: 'CONTROL_NET', link: 108 },
                { name: 'image', type: 'IMAGE', link: 149 },
              ],
              outputs: [
                { name: 'positive', type: 'CONDITIONING', links: [111], shape: 3, slot_index: 0 },
                { name: 'negative', type: 'CONDITIONING', links: [112], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'ControlNetApplyAdvanced' },
              widgets_values: [controlnet_strength, 0, controlnet_clip],
            },
            {
              id: 39,
              type: 'LineArtPreprocessor',
              pos: [-175, 911],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 8,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 78 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [148, 149, 150], shape: 3, slot_index: 0 },
              ],
              properties: { 'Node name for S&R': 'LineArtPreprocessor' },
              widgets_values: ['enable', line_strength],
            },
            {
              id: 15,
              type: 'ControlNetLoader',
              pos: [204, 752],
              size: { '0': 310, '1': 60 },
              flags: {},
              order: 6,
              mode: 0,
              outputs: [
                {
                  name: 'CONTROL_NET',
                  type: 'CONTROL_NET',
                  links: [108],
                  shape: 3,
                  slot_index: 0,
                  label: 'ControlNet',
                },
              ],
              properties: { 'Node name for S&R': 'ControlNetLoader' },
              widgets_values: [controlnet_name],
            },
            {
              id: 37,
              type: 'CR Upscale Image',
              pos: [1633, 181],
              size: { '0': 315, '1': 222 },
              flags: {},
              order: 23,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 73 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [74], shape: 3, slot_index: 0 },
                { name: 'show_help', type: 'STRING', links: null, shape: 3 },
              ],
              properties: { 'Node name for S&R': 'CR Upscale Image' },
              widgets_values: ['8x_eva_super.pth', 'rescale', hd, 1024, 'lanczos', 'false', 8],
            },
            {
              id: 12,
              type: 'SaveImage',
              pos: [1446, 539],
              size: { '0': 900.6381225585938, '1': 931.7376708984375 },
              flags: {},
              order: 22,
              mode: 4,
              inputs: [{ name: 'images', type: 'IMAGE', link: 13, label: t('图像') }],
              properties: {},
              widgets_values: ['Eva'],
            },
          ],
          links: [
            [1, 3, 0, 5, 0, 'IPADAPTER'],
            [2, 4, 0, 5, 1, 'CLIP_VISION'],
            [3, 6, 0, 5, 2, 'IMAGE'],
            [7, 5, 0, 9, 0, 'MODEL'],
            [11, 9, 0, 11, 0, 'LATENT'],
            [13, 11, 0, 12, 0, 'IMAGE'],
            [21, 1, 0, 18, 0, 'MODEL'],
            [22, 1, 1, 18, 1, 'CLIP'],
            [26, 19, 0, 9, 3, 'LATENT'],
            [28, 1, 2, 19, 1, 'VAE'],
            [70, 36, 0, 5, 3, 'MODEL'],
            [72, 36, 1, 8, 0, 'CLIP'],
            [73, 11, 0, 37, 0, 'IMAGE'],
            [74, 37, 0, 28, 0, 'IMAGE'],
            [78, 14, 0, 39, 0, 'IMAGE'],
            [81, 40, 0, 11, 1, 'VAE'],
            [86, 36, 1, 7, 0, 'CLIP'],
            [106, 18, 0, 36, 0, 'MODEL'],
            [107, 18, 1, 36, 1, 'CLIP'],
            [108, 15, 0, 51, 2, 'CONTROL_NET'],
            [111, 51, 0, 9, 1, 'CONDITIONING'],
            [112, 51, 1, 9, 2, 'CONDITIONING'],
            [114, 7, 0, 51, 0, 'CONDITIONING'],
            [115, 8, 0, 51, 1, 'CONDITIONING'],
            [119, 14, 0, 54, 0, 'IMAGE'],
            [122, 14, 0, 55, 0, 'IMAGE'],
            [135, 14, 0, 61, 0, 'IMAGE'],
            [144, 14, 0, 63, 0, 'IMAGE'],
            [148, 39, 0, 52, 0, 'IMAGE'],
            [149, 39, 0, 51, 3, 'IMAGE'],
            [150, 39, 0, 19, 0, 'IMAGE'],
          ],
          groups: [],
          config: {},
          extra: {},
          version: 0.4,
        },
      },
    },
  };
};

export const fast_canny_and_soft = ({
  client_id,
  load_img,
  style_img,
  text,
  negative,
  ip_adapter_name,
  ip_adapter_strength,
  ckpt,
  lora_name,
  lora_strength,
  lora_clip,
  step,
  cfg,
  sampler_name,
  hd,
  controlnet_strength,
  controlnet_clip,
  controlnet_name,
  line_strength,
}: any) => {
  const input_seed = Math.floor(Math.random() * 1000000000000);
  const prompt = text.replaceAll('，', ',');
  const negative_prompt = negative.replaceAll('，', ',');
  console.log('fast_canny_and_soft', {
    client_id,
    load_img,
    style_img,
    text,
    negative,
    ip_adapter_name,
    ip_adapter_strength,
    ckpt,
    lora_name,
    lora_strength,
    lora_clip,
    step,
    cfg,
    sampler_name,
    hd,
    controlnet_strength,
    controlnet_clip,
    controlnet_name,
    input_seed,
    prompt,
    negative_prompt,
  });
  return {
    client_id: client_id,
    prompt: {
      '1': {
        inputs: { ckpt_name: ckpt },
        class_type: 'CheckpointLoaderSimple',
      },
      '3': {
        inputs: { ipadapter_file: ip_adapter_name },
        class_type: 'IPAdapterModelLoader',
      },
      '4': { inputs: { clip_name: 'SD1.5\\pytorch_model.bin' }, class_type: 'CLIPVisionLoader' },
      '5': {
        inputs: {
          weight: ip_adapter_strength,
          noise: 0.1,
          weight_type: 'original',
          start_at: 0,
          end_at: 1,
          unfold_batch: false,
          ipadapter: ['3', 0],
          clip_vision: ['4', 0],
          image: ['6', 0],
          model: ['36', 0],
        },
        class_type: 'IPAdapterApply',
      },
      '6': { inputs: { image: style_img, upload: 'image' }, class_type: 'LoadImage' },
      '7': {
        inputs: {
          text: prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '8': {
        inputs: {
          text: negative_prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '9': {
        inputs: {
          seed: input_seed,
          steps: step,
          cfg: cfg,
          sampler_name: sampler_name,
          scheduler: 'normal',
          denoise: 0.9500000000000001,
          model: ['5', 0],
          positive: ['51', 0],
          negative: ['51', 1],
          latent_image: ['19', 0],
        },
        class_type: 'KSampler',
      },
      '11': { inputs: { samples: ['9', 0], vae: ['40', 0] }, class_type: 'VAEDecode' },
      '14': { inputs: { image: load_img, upload: 'image' }, class_type: 'LoadImage' },
      '15': {
        inputs: { control_net_name: controlnet_name },
        class_type: 'ControlNetLoader',
      },
      '18': {
        inputs: {
          lora_name: 'lcm-lora-sdv1-5.safetensors',
          strength_model: 1,
          strength_clip: 1,
          model: ['1', 0],
          clip: ['1', 1],
        },
        class_type: 'LoraLoader',
      },
      '19': { inputs: { pixels: ['54', 0], vae: ['1', 2] }, class_type: 'VAEEncode' },
      '28': { inputs: { filename_prefix: 'Eva_HD', images: ['37', 0] }, class_type: 'SaveImage' },
      '36': {
        inputs: {
          lora_name: lora_name ?? 'lcm-lora-sdv1-5.safetensors',
          strength_model: lora_name ? lora_strength : 0,
          strength_clip: lora_name ? lora_clip : 0,
          model: ['18', 0],
          clip: ['18', 1],
        },
        class_type: 'LoraLoader',
      },
      '37': {
        inputs: {
          upscale_model: '8x_eva_super.pth',
          mode: 'rescale',
          rescale_factor: hd,
          resize_width: 1024,
          resampling_method: 'lanczos',
          supersample: 'false',
          rounding_modulus: 8,
          image: ['11', 0],
        },
        class_type: 'CR Upscale Image',
      },
      '39': {
        inputs: { coarse: 'enable', resolution: line_strength, image: ['14', 0] },
        class_type: 'LineArtPreprocessor',
      },
      '40': {
        inputs: { vae_name: '真实感vae-ft-mse-840000-ema-pruned_v10.0.pt' },
        class_type: 'VAELoader',
      },
      '51': {
        inputs: {
          strength: controlnet_strength,
          start_percent: 0,
          end_percent: controlnet_clip,
          positive: ['7', 0],
          negative: ['8', 0],
          control_net: ['15', 0],
          image: ['54', 0],
        },
        class_type: 'ControlNetApplyAdvanced',
      },
      '52': { inputs: { images: ['54', 0] }, class_type: 'PreviewImage' },
      '54': {
        inputs: { low_threshold: 0.4, high_threshold: 0.8, image: ['14', 0] },
        class_type: 'Canny',
      },
      '55': {
        inputs: {
          score_threshold: 0.1,
          dist_threshold: 0.1,
          resolution: line_strength,
          image: ['14', 0],
        },
        class_type: 'M-LSDPreprocessor',
      },
      '61': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'Zoe-DepthMapPreprocessor',
      },
      '63': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'OneFormer-COCO-SemSegPreprocessor',
      },
    },
    extra_data: {
      extra_pnginfo: {
        workflow: {
          last_node_id: 63,
          last_link_id: 153,
          nodes: [
            {
              id: 19,
              type: 'VAEEncode',
              pos: [955, 532],
              size: { '0': 210, '1': 46 },
              flags: {},
              order: 15,
              mode: 0,
              inputs: [
                { name: 'pixels', type: 'IMAGE', link: 153 },
                { name: 'vae', type: 'VAE', link: 28 },
              ],
              outputs: [{ name: 'LATENT', type: 'LATENT', links: [26], shape: 3 }],
              properties: { 'Node name for S&R': 'VAEEncode' },
            },
            {
              id: 11,
              type: 'VAEDecode',
              pos: [1300, 170],
              size: { '0': 140, '1': 50 },
              flags: {},
              order: 21,
              mode: 0,
              inputs: [
                { name: 'samples', type: 'LATENT', link: 11, label: 'Latent' },
                { name: 'vae', type: 'VAE', link: 81, label: 'VAE', slot_index: 1 },
              ],
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [13, 73],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
              ],
              properties: { 'Node name for S&R': 'VAEDecode' },
            },
            {
              id: 40,
              type: 'VAELoader',
              pos: [1242, 9],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 0,
              mode: 0,
              outputs: [{ name: 'VAE', type: 'VAE', links: [81], shape: 3 }],
              properties: { 'Node name for S&R': 'VAELoader' },
              widgets_values: ['真实感vae-ft-mse-840000-ema-pruned_v10.0.pt'],
            },
            {
              id: 4,
              type: 'CLIPVisionLoader',
              pos: [178, -39],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 1,
              mode: 0,
              outputs: [
                {
                  name: 'CLIP_VISION',
                  type: 'CLIP_VISION',
                  links: [2],
                  shape: 3,
                  slot_index: 0,
                  label: t('CLIP视觉'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPVisionLoader' },
              widgets_values: ['SD1.5\\pytorch_model.bin'],
            },
            {
              id: 1,
              type: 'CheckpointLoaderSimple',
              pos: [179, 74],
              size: { '0': 300, '1': 100 },
              flags: {},
              order: 2,
              mode: 0,
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [21],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
                { name: 'CLIP', type: 'CLIP', links: [22], shape: 3, slot_index: 1, label: 'CLIP' },
                { name: 'VAE', type: 'VAE', links: [28], shape: 3, label: 'VAE', slot_index: 2 },
              ],
              properties: { 'Node name for S&R': 'CheckpointLoaderSimple' },
              widgets_values: [ckpt],
            },
            {
              id: 3,
              type: 'IPAdapterModelLoader',
              pos: [181, -156],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 3,
              mode: 0,
              outputs: [
                {
                  name: 'IPADAPTER',
                  type: 'IPADAPTER',
                  links: [1],
                  shape: 3,
                  slot_index: 0,
                  label: t('IP适配'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterModelLoader' },
              widgets_values: [ip_adapter_name],
            },
            {
              id: 28,
              type: 'SaveImage',
              pos: [2436, 482],
              size: { '0': 1673.71728515625, '1': 1076.5091552734375 },
              flags: {},
              order: 24,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 74 }],
              properties: {},
              widgets_values: ['Eva_HD'],
            },
            {
              id: 9,
              type: 'KSampler',
              pos: [926, 167],
              size: { '0': 320.16607666015625, '1': 262 },
              flags: {},
              order: 20,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 7, label: t('模型') },
                { name: 'positive', type: 'CONDITIONING', link: 111, label: t('正面提示词') },
                { name: 'negative', type: 'CONDITIONING', link: 112, label: t('负面提示词') },
                { name: 'latent_image', type: 'LATENT', link: 26, label: 'Latent', slot_index: 3 },
              ],
              outputs: [
                {
                  name: 'LATENT',
                  type: 'LATENT',
                  links: [11],
                  shape: 3,
                  slot_index: 0,
                  label: 'Latent',
                },
              ],
              properties: { 'Node name for S&R': 'KSampler' },
              widgets_values: [
                input_seed,
                'randomize',
                step,
                cfg,
                sampler_name,
                'normal',
                0.9500000000000001,
              ],
            },
            {
              id: 6,
              type: 'LoadImage',
              pos: [941, 670],
              size: { '0': 453.823486328125, '1': 476.8275146484375 },
              flags: {},
              order: 4,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [3],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [style_img, 'image'],
            },
            {
              id: 8,
              type: 'CLIPTextEncode',
              pos: [650, 420],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 17,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 72, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [115],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [negative_prompt],
              color: '#322',
              bgcolor: '#533',
            },
            {
              id: 55,
              type: 'M-LSDPreprocessor',
              pos: [-183, 603],
              size: { '0': 315, '1': 106 },
              flags: {},
              order: 10,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 122 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'M-LSDPreprocessor' },
              widgets_values: [0.1, 0.1, line_strength],
            },
            {
              id: 61,
              type: 'Zoe-DepthMapPreprocessor',
              pos: [-185, 480],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 11,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 135 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'Zoe-DepthMapPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 14,
              type: 'LoadImage',
              pos: [-430, 1130],
              size: { '0': 666.5375366210938, '1': 772.7017822265625 },
              flags: {},
              order: 5,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [78, 119, 122, 135, 144],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [load_img, 'image'],
            },
            {
              id: 52,
              type: 'PreviewImage',
              pos: [319, 1129],
              size: { '0': 567.489990234375, '1': 477.95001220703125 },
              flags: {},
              order: 14,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 151 }],
              properties: { 'Node name for S&R': 'PreviewImage' },
            },
            {
              id: 63,
              type: 'OneFormer-COCO-SemSegPreprocessor',
              pos: [-181, 342],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 12,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 144 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'OneFormer-COCO-SemSegPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 36,
              type: 'LoraLoader',
              pos: [176, 430],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 13,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 106 },
                { name: 'clip', type: 'CLIP', link: 107 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [70], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [72, 86], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: [
                lora_name ?? 'lcm-lora-sdv1-5.safetensors',
                lora_name ? lora_strength : 0,
                lora_name ? lora_clip : 0,
              ],
            },
            {
              id: 18,
              type: 'LoraLoader',
              pos: [172, 232],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 7,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 21 },
                { name: 'clip', type: 'CLIP', link: 22 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [106], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [107], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: ['lcm-lora-sdv1-5.safetensors', 1, 1],
            },
            {
              id: 5,
              type: 'IPAdapterApply',
              pos: [649, -79],
              size: { '0': 210, '1': 258 },
              flags: {},
              order: 16,
              mode: 0,
              inputs: [
                { name: 'ipadapter', type: 'IPADAPTER', link: 1, label: t('IP适配') },
                { name: 'clip_vision', type: 'CLIP_VISION', link: 2, label: t('CLIP视觉') },
                { name: 'image', type: 'IMAGE', link: 3, label: t('图像') },
                { name: 'model', type: 'MODEL', link: 70, label: t('模型') },
                { name: 'attn_mask', type: 'MASK', link: null },
              ],
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [7],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterApply' },
              widgets_values: [ip_adapter_strength, 0.1, 'original', 0, 1, false],
            },
            {
              id: 7,
              type: 'CLIPTextEncode',
              pos: [650, 250],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 18,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 86, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [114],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [prompt],
              color: '#232',
              bgcolor: '#353',
            },
            {
              id: 51,
              type: 'ControlNetApplyAdvanced',
              pos: [561, 737],
              size: { '0': 315, '1': 166 },
              flags: {},
              order: 19,
              mode: 0,
              inputs: [
                { name: 'positive', type: 'CONDITIONING', link: 114 },
                { name: 'negative', type: 'CONDITIONING', link: 115 },
                { name: 'control_net', type: 'CONTROL_NET', link: 108 },
                { name: 'image', type: 'IMAGE', link: 152 },
              ],
              outputs: [
                { name: 'positive', type: 'CONDITIONING', links: [111], shape: 3, slot_index: 0 },
                { name: 'negative', type: 'CONDITIONING', links: [112], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'ControlNetApplyAdvanced' },
              widgets_values: [controlnet_strength, 0, controlnet_clip],
            },
            {
              id: 39,
              type: 'LineArtPreprocessor',
              pos: [-175, 911],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 8,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 78 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'LineArtPreprocessor' },
              widgets_values: ['enable', line_strength],
            },
            {
              id: 37,
              type: 'CR Upscale Image',
              pos: [1633, 181],
              size: { '0': 315, '1': 222 },
              flags: {},
              order: 23,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 73 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [74], shape: 3, slot_index: 0 },
                { name: 'show_help', type: 'STRING', links: null, shape: 3 },
              ],
              properties: { 'Node name for S&R': 'CR Upscale Image' },
              widgets_values: ['8x_eva_super.pth', 'rescale', hd, 1024, 'lanczos', 'false', 8],
            },
            {
              id: 12,
              type: 'SaveImage',
              pos: [1446, 539],
              size: { '0': 900.6381225585938, '1': 931.7376708984375 },
              flags: {},
              order: 22,
              mode: 4,
              inputs: [{ name: 'images', type: 'IMAGE', link: 13, label: t('图像') }],
              properties: {},
              widgets_values: ['Eva'],
            },
            {
              id: 54,
              type: 'Canny',
              pos: [-184, 769],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 9,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 119 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [151, 152, 153], shape: 3, slot_index: 0 },
              ],
              properties: { 'Node name for S&R': 'Canny' },
              widgets_values: [0.4, 0.8],
            },
            {
              id: 15,
              type: 'ControlNetLoader',
              pos: [204, 752],
              size: { '0': 310, '1': 60 },
              flags: {},
              order: 6,
              mode: 0,
              outputs: [
                {
                  name: 'CONTROL_NET',
                  type: 'CONTROL_NET',
                  links: [108],
                  shape: 3,
                  slot_index: 0,
                  label: 'ControlNet',
                },
              ],
              properties: { 'Node name for S&R': 'ControlNetLoader' },
              widgets_values: [controlnet_name],
            },
          ],
          links: [
            [1, 3, 0, 5, 0, 'IPADAPTER'],
            [2, 4, 0, 5, 1, 'CLIP_VISION'],
            [3, 6, 0, 5, 2, 'IMAGE'],
            [7, 5, 0, 9, 0, 'MODEL'],
            [11, 9, 0, 11, 0, 'LATENT'],
            [13, 11, 0, 12, 0, 'IMAGE'],
            [21, 1, 0, 18, 0, 'MODEL'],
            [22, 1, 1, 18, 1, 'CLIP'],
            [26, 19, 0, 9, 3, 'LATENT'],
            [28, 1, 2, 19, 1, 'VAE'],
            [70, 36, 0, 5, 3, 'MODEL'],
            [72, 36, 1, 8, 0, 'CLIP'],
            [73, 11, 0, 37, 0, 'IMAGE'],
            [74, 37, 0, 28, 0, 'IMAGE'],
            [78, 14, 0, 39, 0, 'IMAGE'],
            [81, 40, 0, 11, 1, 'VAE'],
            [86, 36, 1, 7, 0, 'CLIP'],
            [106, 18, 0, 36, 0, 'MODEL'],
            [107, 18, 1, 36, 1, 'CLIP'],
            [108, 15, 0, 51, 2, 'CONTROL_NET'],
            [111, 51, 0, 9, 1, 'CONDITIONING'],
            [112, 51, 1, 9, 2, 'CONDITIONING'],
            [114, 7, 0, 51, 0, 'CONDITIONING'],
            [115, 8, 0, 51, 1, 'CONDITIONING'],
            [119, 14, 0, 54, 0, 'IMAGE'],
            [122, 14, 0, 55, 0, 'IMAGE'],
            [135, 14, 0, 61, 0, 'IMAGE'],
            [144, 14, 0, 63, 0, 'IMAGE'],
            [151, 54, 0, 52, 0, 'IMAGE'],
            [152, 54, 0, 51, 3, 'IMAGE'],
            [153, 54, 0, 19, 0, 'IMAGE'],
          ],
          groups: [],
          config: {},
          extra: {},
          version: 0.4,
        },
      },
    },
  };
};

export const fast_mlsd = ({
  client_id,
  load_img,
  style_img,
  text,
  negative,
  ip_adapter_name,
  ip_adapter_strength,
  ckpt,
  lora_name,
  lora_strength,
  lora_clip,
  step,
  cfg,
  sampler_name,
  hd,
  controlnet_strength,
  controlnet_clip,
  controlnet_name,
  line_strength,
}: any) => {
  const input_seed = Math.floor(Math.random() * 1000000000000);
  const prompt = text.replaceAll('，', ',');
  const negative_prompt = negative.replaceAll('，', ',');
  console.log('fast_mlsd', {
    client_id,
    load_img,
    style_img,
    text,
    negative,
    ip_adapter_name,
    ip_adapter_strength,
    ckpt,
    lora_name,
    lora_strength,
    lora_clip,
    step,
    cfg,
    sampler_name,
    hd,
    controlnet_strength,
    controlnet_clip,
    controlnet_name,
    input_seed,
    prompt,
    negative_prompt,
  });
  return {
    client_id: client_id,
    prompt: {
      '1': {
        inputs: { ckpt_name: ckpt },
        class_type: 'CheckpointLoaderSimple',
      },
      '3': {
        inputs: { ipadapter_file: ip_adapter_name },
        class_type: 'IPAdapterModelLoader',
      },
      '4': { inputs: { clip_name: 'SD1.5\\pytorch_model.bin' }, class_type: 'CLIPVisionLoader' },
      '5': {
        inputs: {
          weight: ip_adapter_strength,
          noise: 0.1,
          weight_type: 'original',
          start_at: 0,
          end_at: 1,
          unfold_batch: false,
          ipadapter: ['3', 0],
          clip_vision: ['4', 0],
          image: ['6', 0],
          model: ['36', 0],
        },
        class_type: 'IPAdapterApply',
      },
      '6': { inputs: { image: style_img, upload: 'image' }, class_type: 'LoadImage' },
      '7': {
        inputs: {
          text: prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '8': {
        inputs: {
          text: negative_prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '9': {
        inputs: {
          seed: input_seed,
          steps: step,
          cfg: cfg,
          sampler_name: sampler_name,
          scheduler: 'normal',
          denoise: 0.9500000000000001,
          model: ['5', 0],
          positive: ['51', 0],
          negative: ['51', 1],
          latent_image: ['19', 0],
        },
        class_type: 'KSampler',
      },
      '11': { inputs: { samples: ['9', 0], vae: ['40', 0] }, class_type: 'VAEDecode' },
      '14': { inputs: { image: load_img, upload: 'image' }, class_type: 'LoadImage' },
      '15': {
        inputs: { control_net_name: controlnet_name },
        class_type: 'ControlNetLoader',
      },
      '18': {
        inputs: {
          lora_name: 'lcm-lora-sdv1-5.safetensors',
          strength_model: 1,
          strength_clip: 1,
          model: ['1', 0],
          clip: ['1', 1],
        },
        class_type: 'LoraLoader',
      },
      '19': { inputs: { pixels: ['55', 0], vae: ['1', 2] }, class_type: 'VAEEncode' },
      '28': { inputs: { filename_prefix: 'Eva_HD', images: ['37', 0] }, class_type: 'SaveImage' },
      '36': {
        inputs: {
          lora_name: lora_name ?? 'lcm-lora-sdv1-5.safetensors',
          strength_model: lora_name ? lora_strength : 0,
          strength_clip: lora_name ? lora_clip : 0,
          model: ['18', 0],
          clip: ['18', 1],
        },
        class_type: 'LoraLoader',
      },
      '37': {
        inputs: {
          upscale_model: '8x_eva_super.pth',
          mode: 'rescale',
          rescale_factor: hd,
          resize_width: 1024,
          resampling_method: 'lanczos',
          supersample: 'false',
          rounding_modulus: 8,
          image: ['11', 0],
        },
        class_type: 'CR Upscale Image',
      },
      '39': {
        inputs: { coarse: 'enable', resolution: line_strength, image: ['14', 0] },
        class_type: 'LineArtPreprocessor',
      },
      '40': {
        inputs: { vae_name: '真实感vae-ft-mse-840000-ema-pruned_v10.0.pt' },
        class_type: 'VAELoader',
      },
      '51': {
        inputs: {
          strength: controlnet_strength,
          start_percent: 0,
          end_percent: controlnet_clip,
          positive: ['7', 0],
          negative: ['8', 0],
          control_net: ['15', 0],
          image: ['55', 0],
        },
        class_type: 'ControlNetApplyAdvanced',
      },
      '52': { inputs: { images: ['55', 0] }, class_type: 'PreviewImage' },
      '54': {
        inputs: { low_threshold: 0.4, high_threshold: 0.8, image: ['14', 0] },
        class_type: 'Canny',
      },
      '55': {
        inputs: {
          score_threshold: 0.1,
          dist_threshold: 0.1,
          resolution: line_strength,
          image: ['14', 0],
        },
        class_type: 'M-LSDPreprocessor',
      },
      '61': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'Zoe-DepthMapPreprocessor',
      },
      '63': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'OneFormer-COCO-SemSegPreprocessor',
      },
    },
    extra_data: {
      extra_pnginfo: {
        workflow: {
          last_node_id: 63,
          last_link_id: 162,
          nodes: [
            {
              id: 19,
              type: 'VAEEncode',
              pos: [955, 532],
              size: { '0': 210, '1': 46 },
              flags: {},
              order: 14,
              mode: 0,
              inputs: [
                { name: 'pixels', type: 'IMAGE', link: 161 },
                { name: 'vae', type: 'VAE', link: 28 },
              ],
              outputs: [{ name: 'LATENT', type: 'LATENT', links: [26], shape: 3 }],
              properties: { 'Node name for S&R': 'VAEEncode' },
            },
            {
              id: 11,
              type: 'VAEDecode',
              pos: [1300, 170],
              size: { '0': 140, '1': 50 },
              flags: {},
              order: 21,
              mode: 0,
              inputs: [
                { name: 'samples', type: 'LATENT', link: 11, label: 'Latent' },
                { name: 'vae', type: 'VAE', link: 81, label: 'VAE', slot_index: 1 },
              ],
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [13, 73],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
              ],
              properties: { 'Node name for S&R': 'VAEDecode' },
            },
            {
              id: 40,
              type: 'VAELoader',
              pos: [1242, 9],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 0,
              mode: 0,
              outputs: [{ name: 'VAE', type: 'VAE', links: [81], shape: 3 }],
              properties: { 'Node name for S&R': 'VAELoader' },
              widgets_values: ['真实感vae-ft-mse-840000-ema-pruned_v10.0.pt'],
            },
            {
              id: 4,
              type: 'CLIPVisionLoader',
              pos: [178, -39],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 1,
              mode: 0,
              outputs: [
                {
                  name: 'CLIP_VISION',
                  type: 'CLIP_VISION',
                  links: [2],
                  shape: 3,
                  slot_index: 0,
                  label: t('CLIP视觉'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPVisionLoader' },
              widgets_values: ['SD1.5\\pytorch_model.bin'],
            },
            {
              id: 1,
              type: 'CheckpointLoaderSimple',
              pos: [179, 74],
              size: { '0': 300, '1': 100 },
              flags: {},
              order: 2,
              mode: 0,
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [21],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
                { name: 'CLIP', type: 'CLIP', links: [22], shape: 3, slot_index: 1, label: 'CLIP' },
                { name: 'VAE', type: 'VAE', links: [28], shape: 3, label: 'VAE', slot_index: 2 },
              ],
              properties: { 'Node name for S&R': 'CheckpointLoaderSimple' },
              widgets_values: [ckpt],
            },
            {
              id: 3,
              type: 'IPAdapterModelLoader',
              pos: [181, -156],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 3,
              mode: 0,
              outputs: [
                {
                  name: 'IPADAPTER',
                  type: 'IPADAPTER',
                  links: [1],
                  shape: 3,
                  slot_index: 0,
                  label: t('IP适配'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterModelLoader' },
              widgets_values: [ip_adapter_name],
            },
            {
              id: 28,
              type: 'SaveImage',
              pos: [2436, 482],
              size: { '0': 1673.71728515625, '1': 1076.5091552734375 },
              flags: {},
              order: 24,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 74 }],
              properties: {},
              widgets_values: ['Eva_HD'],
            },
            {
              id: 9,
              type: 'KSampler',
              pos: [926, 167],
              size: { '0': 320.16607666015625, '1': 262 },
              flags: {},
              order: 20,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 7, label: t('模型') },
                { name: 'positive', type: 'CONDITIONING', link: 111, label: t('正面提示词') },
                { name: 'negative', type: 'CONDITIONING', link: 112, label: t('负面提示词') },
                { name: 'latent_image', type: 'LATENT', link: 26, label: 'Latent', slot_index: 3 },
              ],
              outputs: [
                {
                  name: 'LATENT',
                  type: 'LATENT',
                  links: [11],
                  shape: 3,
                  slot_index: 0,
                  label: 'Latent',
                },
              ],
              properties: { 'Node name for S&R': 'KSampler' },
              widgets_values: [
                input_seed,
                'randomize',
                step,
                cfg,
                sampler_name,
                'normal',
                0.9500000000000001,
              ],
            },
            {
              id: 6,
              type: 'LoadImage',
              pos: [941, 670],
              size: { '0': 453.823486328125, '1': 476.8275146484375 },
              flags: {},
              order: 4,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [3],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [style_img, 'image'],
            },
            {
              id: 8,
              type: 'CLIPTextEncode',
              pos: [650, 420],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 17,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 72, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [115],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [negative_prompt],
              color: '#322',
              bgcolor: '#533',
            },
            {
              id: 14,
              type: 'LoadImage',
              pos: [-430, 1130],
              size: { '0': 666.5375366210938, '1': 772.7017822265625 },
              flags: {},
              order: 5,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [78, 119, 122, 135, 144],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [load_img, 'image'],
            },
            {
              id: 52,
              type: 'PreviewImage',
              pos: [319, 1129],
              size: { '0': 567.489990234375, '1': 477.95001220703125 },
              flags: {},
              order: 15,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 162 }],
              properties: { 'Node name for S&R': 'PreviewImage' },
            },
            {
              id: 63,
              type: 'OneFormer-COCO-SemSegPreprocessor',
              pos: [-181, 342],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 12,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 144 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'OneFormer-COCO-SemSegPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 36,
              type: 'LoraLoader',
              pos: [176, 430],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 13,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 106 },
                { name: 'clip', type: 'CLIP', link: 107 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [70], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [72, 86], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: [
                lora_name ?? 'lcm-lora-sdv1-5.safetensors',
                lora_name ? lora_strength : 0,
                lora_name ? lora_clip : 0,
              ],
            },
            {
              id: 18,
              type: 'LoraLoader',
              pos: [172, 232],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 7,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 21 },
                { name: 'clip', type: 'CLIP', link: 22 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [106], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [107], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: ['lcm-lora-sdv1-5.safetensors', 1, 1],
            },
            {
              id: 5,
              type: 'IPAdapterApply',
              pos: [649, -79],
              size: { '0': 210, '1': 258 },
              flags: {},
              order: 16,
              mode: 0,
              inputs: [
                { name: 'ipadapter', type: 'IPADAPTER', link: 1, label: t('IP适配') },
                { name: 'clip_vision', type: 'CLIP_VISION', link: 2, label: t('CLIP视觉') },
                { name: 'image', type: 'IMAGE', link: 3, label: t('图像') },
                { name: 'model', type: 'MODEL', link: 70, label: t('模型') },
                { name: 'attn_mask', type: 'MASK', link: null },
              ],
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [7],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterApply' },
              widgets_values: [ip_adapter_strength, 0.1, 'original', 0, 1, false],
            },
            {
              id: 7,
              type: 'CLIPTextEncode',
              pos: [650, 250],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 18,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 86, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [114],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [prompt],
              color: '#232',
              bgcolor: '#353',
            },
            {
              id: 51,
              type: 'ControlNetApplyAdvanced',
              pos: [561, 737],
              size: { '0': 315, '1': 166 },
              flags: {},
              order: 19,
              mode: 0,
              inputs: [
                { name: 'positive', type: 'CONDITIONING', link: 114 },
                { name: 'negative', type: 'CONDITIONING', link: 115 },
                { name: 'control_net', type: 'CONTROL_NET', link: 108 },
                { name: 'image', type: 'IMAGE', link: 160 },
              ],
              outputs: [
                { name: 'positive', type: 'CONDITIONING', links: [111], shape: 3, slot_index: 0 },
                { name: 'negative', type: 'CONDITIONING', links: [112], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'ControlNetApplyAdvanced' },
              widgets_values: [controlnet_strength, 0, controlnet_clip],
            },
            {
              id: 39,
              type: 'LineArtPreprocessor',
              pos: [-175, 911],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 8,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 78 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'LineArtPreprocessor' },
              widgets_values: ['enable', line_strength],
            },
            {
              id: 37,
              type: 'CR Upscale Image',
              pos: [1633, 181],
              size: { '0': 315, '1': 222 },
              flags: {},
              order: 23,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 73 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [74], shape: 3, slot_index: 0 },
                { name: 'show_help', type: 'STRING', links: null, shape: 3 },
              ],
              properties: { 'Node name for S&R': 'CR Upscale Image' },
              widgets_values: ['8x_eva_super.pth', 'rescale', hd, 1024, 'lanczos', 'false', 8],
            },
            {
              id: 12,
              type: 'SaveImage',
              pos: [1446, 539],
              size: { '0': 900.6381225585938, '1': 931.7376708984375 },
              flags: {},
              order: 22,
              mode: 4,
              inputs: [{ name: 'images', type: 'IMAGE', link: 13, label: t('图像') }],
              properties: {},
              widgets_values: ['Eva'],
            },
            {
              id: 54,
              type: 'Canny',
              pos: [-184, 769],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 9,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 119 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'Canny' },
              widgets_values: [0.4, 0.8],
            },
            {
              id: 15,
              type: 'ControlNetLoader',
              pos: [204, 752],
              size: { '0': 310, '1': 60 },
              flags: {},
              order: 6,
              mode: 0,
              outputs: [
                {
                  name: 'CONTROL_NET',
                  type: 'CONTROL_NET',
                  links: [108],
                  shape: 3,
                  slot_index: 0,
                  label: 'ControlNet',
                },
              ],
              properties: { 'Node name for S&R': 'ControlNetLoader' },
              widgets_values: [controlnet_name],
            },
            {
              id: 61,
              type: 'Zoe-DepthMapPreprocessor',
              pos: [-185, 480],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 11,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 135 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'Zoe-DepthMapPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 55,
              type: 'M-LSDPreprocessor',
              pos: [-183, 603],
              size: { '0': 315, '1': 106 },
              flags: {},
              order: 10,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 122 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [160, 161, 162], shape: 3, slot_index: 0 },
              ],
              properties: { 'Node name for S&R': 'M-LSDPreprocessor' },
              widgets_values: [0.1, 0.1, line_strength],
            },
          ],
          links: [
            [1, 3, 0, 5, 0, 'IPADAPTER'],
            [2, 4, 0, 5, 1, 'CLIP_VISION'],
            [3, 6, 0, 5, 2, 'IMAGE'],
            [7, 5, 0, 9, 0, 'MODEL'],
            [11, 9, 0, 11, 0, 'LATENT'],
            [13, 11, 0, 12, 0, 'IMAGE'],
            [21, 1, 0, 18, 0, 'MODEL'],
            [22, 1, 1, 18, 1, 'CLIP'],
            [26, 19, 0, 9, 3, 'LATENT'],
            [28, 1, 2, 19, 1, 'VAE'],
            [70, 36, 0, 5, 3, 'MODEL'],
            [72, 36, 1, 8, 0, 'CLIP'],
            [73, 11, 0, 37, 0, 'IMAGE'],
            [74, 37, 0, 28, 0, 'IMAGE'],
            [78, 14, 0, 39, 0, 'IMAGE'],
            [81, 40, 0, 11, 1, 'VAE'],
            [86, 36, 1, 7, 0, 'CLIP'],
            [106, 18, 0, 36, 0, 'MODEL'],
            [107, 18, 1, 36, 1, 'CLIP'],
            [108, 15, 0, 51, 2, 'CONTROL_NET'],
            [111, 51, 0, 9, 1, 'CONDITIONING'],
            [112, 51, 1, 9, 2, 'CONDITIONING'],
            [114, 7, 0, 51, 0, 'CONDITIONING'],
            [115, 8, 0, 51, 1, 'CONDITIONING'],
            [119, 14, 0, 54, 0, 'IMAGE'],
            [122, 14, 0, 55, 0, 'IMAGE'],
            [135, 14, 0, 61, 0, 'IMAGE'],
            [144, 14, 0, 63, 0, 'IMAGE'],
            [160, 55, 0, 51, 3, 'IMAGE'],
            [161, 55, 0, 19, 0, 'IMAGE'],
            [162, 55, 0, 52, 0, 'IMAGE'],
          ],
          groups: [],
          config: {},
          extra: {},
          version: 0.4,
        },
      },
    },
  };
};

export const fast_depth = ({
  client_id,
  load_img,
  style_img,
  text,
  negative,
  ip_adapter_name,
  ip_adapter_strength,
  ckpt,
  lora_name,
  lora_strength,
  lora_clip,
  step,
  cfg,
  sampler_name,
  hd,
  controlnet_strength,
  controlnet_clip,
  controlnet_name,
  line_strength,
}: any) => {
  const input_seed = Math.floor(Math.random() * 1000000000000);
  const prompt = text.replaceAll('，', ',');
  const negative_prompt = negative.replaceAll('，', ',');
  console.log('fast_depth', {
    client_id,
    load_img,
    style_img,
    text,
    negative,
    ip_adapter_name,
    ip_adapter_strength,
    ckpt,
    lora_name,
    lora_strength,
    lora_clip,
    step,
    cfg,
    sampler_name,
    hd,
    controlnet_strength,
    controlnet_clip,
    controlnet_name,
    input_seed,
    prompt,
    negative_prompt,
  });
  return {
    client_id: client_id,
    prompt: {
      '1': {
        inputs: { ckpt_name: ckpt },
        class_type: 'CheckpointLoaderSimple',
      },
      '3': {
        inputs: { ipadapter_file: ip_adapter_name },
        class_type: 'IPAdapterModelLoader',
      },
      '4': { inputs: { clip_name: 'SD1.5\\pytorch_model.bin' }, class_type: 'CLIPVisionLoader' },
      '5': {
        inputs: {
          weight: ip_adapter_strength,
          noise: 0.1,
          weight_type: 'original',
          start_at: 0,
          end_at: 1,
          unfold_batch: false,
          ipadapter: ['3', 0],
          clip_vision: ['4', 0],
          image: ['6', 0],
          model: ['36', 0],
        },
        class_type: 'IPAdapterApply',
      },
      '6': { inputs: { image: style_img, upload: 'image' }, class_type: 'LoadImage' },
      '7': {
        inputs: {
          text: prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '8': {
        inputs: {
          text: negative_prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '9': {
        inputs: {
          seed: input_seed,
          steps: step,
          cfg: cfg,
          sampler_name: sampler_name,
          scheduler: 'normal',
          denoise: 0.9500000000000001,
          model: ['5', 0],
          positive: ['51', 0],
          negative: ['51', 1],
          latent_image: ['19', 0],
        },
        class_type: 'KSampler',
      },
      '11': { inputs: { samples: ['9', 0], vae: ['40', 0] }, class_type: 'VAEDecode' },
      '14': { inputs: { image: load_img, upload: 'image' }, class_type: 'LoadImage' },
      '15': {
        inputs: { control_net_name: controlnet_name },
        class_type: 'ControlNetLoader',
      },
      '18': {
        inputs: {
          lora_name: 'lcm-lora-sdv1-5.safetensors',
          strength_model: 1,
          strength_clip: 1,
          model: ['1', 0],
          clip: ['1', 1],
        },
        class_type: 'LoraLoader',
      },
      '19': { inputs: { pixels: ['61', 0], vae: ['1', 2] }, class_type: 'VAEEncode' },
      '28': { inputs: { filename_prefix: 'Eva_HD', images: ['37', 0] }, class_type: 'SaveImage' },
      '36': {
        inputs: {
          lora_name: lora_name ?? 'lcm-lora-sdv1-5.safetensors',
          strength_model: lora_name ? lora_strength : 0,
          strength_clip: lora_name ? lora_clip : 0,
          model: ['18', 0],
          clip: ['18', 1],
        },
        class_type: 'LoraLoader',
      },
      '37': {
        inputs: {
          upscale_model: '8x_eva_super.pth',
          mode: 'rescale',
          rescale_factor: hd,
          resize_width: 1024,
          resampling_method: 'lanczos',
          supersample: 'false',
          rounding_modulus: 8,
          image: ['11', 0],
        },
        class_type: 'CR Upscale Image',
      },
      '39': {
        inputs: { coarse: 'enable', resolution: line_strength, image: ['14', 0] },
        class_type: 'LineArtPreprocessor',
      },
      '40': {
        inputs: { vae_name: '真实感vae-ft-mse-840000-ema-pruned_v10.0.pt' },
        class_type: 'VAELoader',
      },
      '51': {
        inputs: {
          strength: controlnet_strength,
          start_percent: 0,
          end_percent: controlnet_clip,
          positive: ['7', 0],
          negative: ['8', 0],
          control_net: ['15', 0],
          image: ['61', 0],
        },
        class_type: 'ControlNetApplyAdvanced',
      },
      '52': { inputs: { images: ['61', 0] }, class_type: 'PreviewImage' },
      '54': {
        inputs: { low_threshold: 0.4, high_threshold: 0.8, image: ['14', 0] },
        class_type: 'Canny',
      },
      '55': {
        inputs: {
          score_threshold: 0.1,
          dist_threshold: 0.1,
          resolution: line_strength,
          image: ['14', 0],
        },
        class_type: 'M-LSDPreprocessor',
      },
      '61': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'Zoe-DepthMapPreprocessor',
      },
      '63': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'OneFormer-COCO-SemSegPreprocessor',
      },
    },
    extra_data: {
      extra_pnginfo: {
        workflow: {
          last_node_id: 63,
          last_link_id: 165,
          nodes: [
            {
              id: 19,
              type: 'VAEEncode',
              pos: [955, 532],
              size: { '0': 210, '1': 46 },
              flags: {},
              order: 14,
              mode: 0,
              inputs: [
                { name: 'pixels', type: 'IMAGE', link: 164 },
                { name: 'vae', type: 'VAE', link: 28 },
              ],
              outputs: [{ name: 'LATENT', type: 'LATENT', links: [26], shape: 3 }],
              properties: { 'Node name for S&R': 'VAEEncode' },
            },
            {
              id: 11,
              type: 'VAEDecode',
              pos: [1300, 170],
              size: { '0': 140, '1': 50 },
              flags: {},
              order: 21,
              mode: 0,
              inputs: [
                { name: 'samples', type: 'LATENT', link: 11, label: 'Latent' },
                { name: 'vae', type: 'VAE', link: 81, label: 'VAE', slot_index: 1 },
              ],
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [13, 73],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
              ],
              properties: { 'Node name for S&R': 'VAEDecode' },
            },
            {
              id: 40,
              type: 'VAELoader',
              pos: [1242, 9],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 0,
              mode: 0,
              outputs: [{ name: 'VAE', type: 'VAE', links: [81], shape: 3 }],
              properties: { 'Node name for S&R': 'VAELoader' },
              widgets_values: ['真实感vae-ft-mse-840000-ema-pruned_v10.0.pt'],
            },
            {
              id: 4,
              type: 'CLIPVisionLoader',
              pos: [178, -39],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 1,
              mode: 0,
              outputs: [
                {
                  name: 'CLIP_VISION',
                  type: 'CLIP_VISION',
                  links: [2],
                  shape: 3,
                  slot_index: 0,
                  label: t('CLIP视觉'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPVisionLoader' },
              widgets_values: ['SD1.5\\pytorch_model.bin'],
            },
            {
              id: 1,
              type: 'CheckpointLoaderSimple',
              pos: [179, 74],
              size: { '0': 300, '1': 100 },
              flags: {},
              order: 2,
              mode: 0,
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [21],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
                { name: 'CLIP', type: 'CLIP', links: [22], shape: 3, slot_index: 1, label: 'CLIP' },
                { name: 'VAE', type: 'VAE', links: [28], shape: 3, label: 'VAE', slot_index: 2 },
              ],
              properties: { 'Node name for S&R': 'CheckpointLoaderSimple' },
              widgets_values: [ckpt],
            },
            {
              id: 3,
              type: 'IPAdapterModelLoader',
              pos: [181, -156],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 3,
              mode: 0,
              outputs: [
                {
                  name: 'IPADAPTER',
                  type: 'IPADAPTER',
                  links: [1],
                  shape: 3,
                  slot_index: 0,
                  label: t('IP适配'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterModelLoader' },
              widgets_values: [ip_adapter_name],
            },
            {
              id: 28,
              type: 'SaveImage',
              pos: [2436, 482],
              size: { '0': 1673.71728515625, '1': 1076.5091552734375 },
              flags: {},
              order: 24,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 74 }],
              properties: {},
              widgets_values: ['Eva_HD'],
            },
            {
              id: 9,
              type: 'KSampler',
              pos: [926, 167],
              size: { '0': 320.16607666015625, '1': 262 },
              flags: {},
              order: 20,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 7, label: t('模型') },
                { name: 'positive', type: 'CONDITIONING', link: 111, label: t('正面提示词') },
                { name: 'negative', type: 'CONDITIONING', link: 112, label: t('负面提示词') },
                { name: 'latent_image', type: 'LATENT', link: 26, label: 'Latent', slot_index: 3 },
              ],
              outputs: [
                {
                  name: 'LATENT',
                  type: 'LATENT',
                  links: [11],
                  shape: 3,
                  slot_index: 0,
                  label: 'Latent',
                },
              ],
              properties: { 'Node name for S&R': 'KSampler' },
              widgets_values: [
                input_seed,
                'randomize',
                step,
                cfg,
                sampler_name,
                'normal',
                0.9500000000000001,
              ],
            },
            {
              id: 6,
              type: 'LoadImage',
              pos: [941, 670],
              size: { '0': 453.823486328125, '1': 476.8275146484375 },
              flags: {},
              order: 4,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [3],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [style_img, 'image'],
            },
            {
              id: 8,
              type: 'CLIPTextEncode',
              pos: [650, 420],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 17,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 72, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [115],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [negative_prompt],
              color: '#322',
              bgcolor: '#533',
            },
            {
              id: 14,
              type: 'LoadImage',
              pos: [-430, 1130],
              size: { '0': 666.5375366210938, '1': 772.7017822265625 },
              flags: {},
              order: 5,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [78, 119, 122, 135, 144],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [load_img, 'image'],
            },
            {
              id: 52,
              type: 'PreviewImage',
              pos: [319, 1129],
              size: { '0': 567.489990234375, '1': 477.95001220703125 },
              flags: {},
              order: 15,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 165 }],
              properties: { 'Node name for S&R': 'PreviewImage' },
            },
            {
              id: 63,
              type: 'OneFormer-COCO-SemSegPreprocessor',
              pos: [-181, 342],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 12,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 144 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'OneFormer-COCO-SemSegPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 36,
              type: 'LoraLoader',
              pos: [176, 430],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 13,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 106 },
                { name: 'clip', type: 'CLIP', link: 107 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [70], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [72, 86], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: [
                lora_name ?? 'lcm-lora-sdv1-5.safetensors',
                lora_name ? lora_strength : 0,
                lora_name ? lora_clip : 0,
              ],
            },
            {
              id: 18,
              type: 'LoraLoader',
              pos: [172, 232],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 7,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 21 },
                { name: 'clip', type: 'CLIP', link: 22 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [106], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [107], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: ['lcm-lora-sdv1-5.safetensors', 1, 1],
            },
            {
              id: 5,
              type: 'IPAdapterApply',
              pos: [649, -79],
              size: { '0': 210, '1': 258 },
              flags: {},
              order: 16,
              mode: 0,
              inputs: [
                { name: 'ipadapter', type: 'IPADAPTER', link: 1, label: t('IP适配') },
                { name: 'clip_vision', type: 'CLIP_VISION', link: 2, label: t('CLIP视觉') },
                { name: 'image', type: 'IMAGE', link: 3, label: t('图像') },
                { name: 'model', type: 'MODEL', link: 70, label: t('模型') },
                { name: 'attn_mask', type: 'MASK', link: null },
              ],
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [7],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterApply' },
              widgets_values: [ip_adapter_strength, 0.1, 'original', 0, 1, false],
            },
            {
              id: 7,
              type: 'CLIPTextEncode',
              pos: [650, 250],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 18,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 86, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [114],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [prompt],
              color: '#232',
              bgcolor: '#353',
            },
            {
              id: 51,
              type: 'ControlNetApplyAdvanced',
              pos: [561, 737],
              size: { '0': 315, '1': 166 },
              flags: {},
              order: 19,
              mode: 0,
              inputs: [
                { name: 'positive', type: 'CONDITIONING', link: 114 },
                { name: 'negative', type: 'CONDITIONING', link: 115 },
                { name: 'control_net', type: 'CONTROL_NET', link: 108 },
                { name: 'image', type: 'IMAGE', link: 163 },
              ],
              outputs: [
                { name: 'positive', type: 'CONDITIONING', links: [111], shape: 3, slot_index: 0 },
                { name: 'negative', type: 'CONDITIONING', links: [112], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'ControlNetApplyAdvanced' },
              widgets_values: [controlnet_strength, 0, controlnet_clip],
            },
            {
              id: 39,
              type: 'LineArtPreprocessor',
              pos: [-175, 911],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 8,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 78 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'LineArtPreprocessor' },
              widgets_values: ['enable', line_strength],
            },
            {
              id: 37,
              type: 'CR Upscale Image',
              pos: [1633, 181],
              size: { '0': 315, '1': 222 },
              flags: {},
              order: 23,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 73 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [74], shape: 3, slot_index: 0 },
                { name: 'show_help', type: 'STRING', links: null, shape: 3 },
              ],
              properties: { 'Node name for S&R': 'CR Upscale Image' },
              widgets_values: ['8x_eva_super.pth', 'rescale', hd, 1024, 'lanczos', 'false', 8],
            },
            {
              id: 12,
              type: 'SaveImage',
              pos: [1446, 539],
              size: { '0': 900.6381225585938, '1': 931.7376708984375 },
              flags: {},
              order: 22,
              mode: 4,
              inputs: [{ name: 'images', type: 'IMAGE', link: 13, label: t('图像') }],
              properties: {},
              widgets_values: ['Eva'],
            },
            {
              id: 54,
              type: 'Canny',
              pos: [-184, 769],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 9,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 119 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'Canny' },
              widgets_values: [0.4, 0.8],
            },
            {
              id: 55,
              type: 'M-LSDPreprocessor',
              pos: [-183, 603],
              size: { '0': 315, '1': 106 },
              flags: {},
              order: 10,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 122 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'M-LSDPreprocessor' },
              widgets_values: [0.1, 0.1, line_strength],
            },
            {
              id: 61,
              type: 'Zoe-DepthMapPreprocessor',
              pos: [-185, 480],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 11,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 135 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [163, 164, 165], shape: 3, slot_index: 0 },
              ],
              properties: { 'Node name for S&R': 'Zoe-DepthMapPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 15,
              type: 'ControlNetLoader',
              pos: [204, 752],
              size: { '0': 310, '1': 60 },
              flags: {},
              order: 6,
              mode: 0,
              outputs: [
                {
                  name: 'CONTROL_NET',
                  type: 'CONTROL_NET',
                  links: [108],
                  shape: 3,
                  slot_index: 0,
                  label: 'ControlNet',
                },
              ],
              properties: { 'Node name for S&R': 'ControlNetLoader' },
              widgets_values: [controlnet_name],
            },
          ],
          links: [
            [1, 3, 0, 5, 0, 'IPADAPTER'],
            [2, 4, 0, 5, 1, 'CLIP_VISION'],
            [3, 6, 0, 5, 2, 'IMAGE'],
            [7, 5, 0, 9, 0, 'MODEL'],
            [11, 9, 0, 11, 0, 'LATENT'],
            [13, 11, 0, 12, 0, 'IMAGE'],
            [21, 1, 0, 18, 0, 'MODEL'],
            [22, 1, 1, 18, 1, 'CLIP'],
            [26, 19, 0, 9, 3, 'LATENT'],
            [28, 1, 2, 19, 1, 'VAE'],
            [70, 36, 0, 5, 3, 'MODEL'],
            [72, 36, 1, 8, 0, 'CLIP'],
            [73, 11, 0, 37, 0, 'IMAGE'],
            [74, 37, 0, 28, 0, 'IMAGE'],
            [78, 14, 0, 39, 0, 'IMAGE'],
            [81, 40, 0, 11, 1, 'VAE'],
            [86, 36, 1, 7, 0, 'CLIP'],
            [106, 18, 0, 36, 0, 'MODEL'],
            [107, 18, 1, 36, 1, 'CLIP'],
            [108, 15, 0, 51, 2, 'CONTROL_NET'],
            [111, 51, 0, 9, 1, 'CONDITIONING'],
            [112, 51, 1, 9, 2, 'CONDITIONING'],
            [114, 7, 0, 51, 0, 'CONDITIONING'],
            [115, 8, 0, 51, 1, 'CONDITIONING'],
            [119, 14, 0, 54, 0, 'IMAGE'],
            [122, 14, 0, 55, 0, 'IMAGE'],
            [135, 14, 0, 61, 0, 'IMAGE'],
            [144, 14, 0, 63, 0, 'IMAGE'],
            [163, 61, 0, 51, 3, 'IMAGE'],
            [164, 61, 0, 19, 0, 'IMAGE'],
            [165, 61, 0, 52, 0, 'IMAGE'],
          ],
          groups: [],
          config: {},
          extra: {},
          version: 0.4,
        },
      },
    },
  };
};

export const fast_seg = ({
  client_id,
  load_img,
  style_img,
  text,
  negative,
  ip_adapter_name,
  ip_adapter_strength,
  ckpt,
  lora_name,
  lora_strength,
  lora_clip,
  step,
  cfg,
  sampler_name,
  hd,
  controlnet_strength,
  controlnet_clip,
  controlnet_name,
  line_strength,
}: any) => {
  const input_seed = Math.floor(Math.random() * 1000000000000);
  const prompt = text.replaceAll('，', ',');
  const negative_prompt = negative.replaceAll('，', ',');
  console.log('fast_seg', {
    client_id,
    load_img,
    style_img,
    text,
    negative,
    ip_adapter_name,
    ip_adapter_strength,
    ckpt,
    lora_name,
    lora_strength,
    lora_clip,
    step,
    cfg,
    sampler_name,
    hd,
    controlnet_strength,
    controlnet_clip,
    controlnet_name,
    input_seed,
    prompt,
    negative_prompt,
  });
  return {
    client_id: client_id,
    prompt: {
      '1': {
        inputs: { ckpt_name: ckpt },
        class_type: 'CheckpointLoaderSimple',
      },
      '3': {
        inputs: { ipadapter_file: ip_adapter_name },
        class_type: 'IPAdapterModelLoader',
      },
      '4': { inputs: { clip_name: 'SD1.5\\pytorch_model.bin' }, class_type: 'CLIPVisionLoader' },
      '5': {
        inputs: {
          weight: ip_adapter_strength,
          noise: 0.1,
          weight_type: 'original',
          start_at: 0,
          end_at: 1,
          unfold_batch: false,
          ipadapter: ['3', 0],
          clip_vision: ['4', 0],
          image: ['6', 0],
          model: ['36', 0],
        },
        class_type: 'IPAdapterApply',
      },
      '6': { inputs: { image: style_img, upload: 'image' }, class_type: 'LoadImage' },
      '7': {
        inputs: {
          text: prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '8': {
        inputs: {
          text: negative_prompt,
          clip: ['36', 1],
        },
        class_type: 'CLIPTextEncode',
      },
      '9': {
        inputs: {
          seed: input_seed,
          steps: step,
          cfg: cfg,
          sampler_name: sampler_name,
          scheduler: 'normal',
          denoise: 0.9500000000000001,
          model: ['5', 0],
          positive: ['51', 0],
          negative: ['51', 1],
          latent_image: ['19', 0],
        },
        class_type: 'KSampler',
      },
      '11': { inputs: { samples: ['9', 0], vae: ['40', 0] }, class_type: 'VAEDecode' },
      '14': { inputs: { image: load_img, upload: 'image' }, class_type: 'LoadImage' },
      '15': {
        inputs: { control_net_name: controlnet_name },
        class_type: 'ControlNetLoader',
      },
      '18': {
        inputs: {
          lora_name: 'lcm-lora-sdv1-5.safetensors',
          strength_model: 1,
          strength_clip: 1,
          model: ['1', 0],
          clip: ['1', 1],
        },
        class_type: 'LoraLoader',
      },
      '19': { inputs: { pixels: ['63', 0], vae: ['1', 2] }, class_type: 'VAEEncode' },
      '28': { inputs: { filename_prefix: 'Eva_HD', images: ['37', 0] }, class_type: 'SaveImage' },
      '36': {
        inputs: {
          lora_name: lora_name ?? 'lcm-lora-sdv1-5.safetensors',
          strength_model: lora_name ? lora_strength : 0,
          strength_clip: lora_name ? lora_clip : 0,
          model: ['18', 0],
          clip: ['18', 1],
        },
        class_type: 'LoraLoader',
      },
      '37': {
        inputs: {
          upscale_model: '8x_eva_super.pth',
          mode: 'rescale',
          rescale_factor: hd,
          resize_width: 1024,
          resampling_method: 'lanczos',
          supersample: 'false',
          rounding_modulus: 8,
          image: ['11', 0],
        },
        class_type: 'CR Upscale Image',
      },
      '39': {
        inputs: { coarse: 'enable', resolution: line_strength, image: ['14', 0] },
        class_type: 'LineArtPreprocessor',
      },
      '40': {
        inputs: { vae_name: '真实感vae-ft-mse-840000-ema-pruned_v10.0.pt' },
        class_type: 'VAELoader',
      },
      '51': {
        inputs: {
          strength: controlnet_strength,
          start_percent: 0,
          end_percent: controlnet_clip,
          positive: ['7', 0],
          negative: ['8', 0],
          control_net: ['15', 0],
          image: ['63', 0],
        },
        class_type: 'ControlNetApplyAdvanced',
      },
      '52': { inputs: { images: ['63', 0] }, class_type: 'PreviewImage' },
      '54': {
        inputs: { low_threshold: 0.4, high_threshold: 0.8, image: ['14', 0] },
        class_type: 'Canny',
      },
      '55': {
        inputs: {
          score_threshold: 0.1,
          dist_threshold: 0.1,
          resolution: line_strength,
          image: ['14', 0],
        },
        class_type: 'M-LSDPreprocessor',
      },
      '61': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'Zoe-DepthMapPreprocessor',
      },
      '63': {
        inputs: { resolution: line_strength, image: ['14', 0] },
        class_type: 'OneFormer-COCO-SemSegPreprocessor',
      },
    },
    extra_data: {
      extra_pnginfo: {
        workflow: {
          last_node_id: 63,
          last_link_id: 168,
          nodes: [
            {
              id: 19,
              type: 'VAEEncode',
              pos: [955, 532],
              size: { '0': 210, '1': 46 },
              flags: {},
              order: 15,
              mode: 0,
              inputs: [
                { name: 'pixels', type: 'IMAGE', link: 168 },
                { name: 'vae', type: 'VAE', link: 28 },
              ],
              outputs: [{ name: 'LATENT', type: 'LATENT', links: [26], shape: 3 }],
              properties: { 'Node name for S&R': 'VAEEncode' },
            },
            {
              id: 11,
              type: 'VAEDecode',
              pos: [1300, 170],
              size: { '0': 140, '1': 50 },
              flags: {},
              order: 21,
              mode: 0,
              inputs: [
                { name: 'samples', type: 'LATENT', link: 11, label: 'Latent' },
                { name: 'vae', type: 'VAE', link: 81, label: 'VAE', slot_index: 1 },
              ],
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [13, 73],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
              ],
              properties: { 'Node name for S&R': 'VAEDecode' },
            },
            {
              id: 40,
              type: 'VAELoader',
              pos: [1242, 9],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 0,
              mode: 0,
              outputs: [{ name: 'VAE', type: 'VAE', links: [81], shape: 3 }],
              properties: { 'Node name for S&R': 'VAELoader' },
              widgets_values: ['真实感vae-ft-mse-840000-ema-pruned_v10.0.pt'],
            },
            {
              id: 4,
              type: 'CLIPVisionLoader',
              pos: [178, -39],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 1,
              mode: 0,
              outputs: [
                {
                  name: 'CLIP_VISION',
                  type: 'CLIP_VISION',
                  links: [2],
                  shape: 3,
                  slot_index: 0,
                  label: t('CLIP视觉'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPVisionLoader' },
              widgets_values: ['SD1.5\\pytorch_model.bin'],
            },
            {
              id: 1,
              type: 'CheckpointLoaderSimple',
              pos: [179, 74],
              size: { '0': 300, '1': 100 },
              flags: {},
              order: 2,
              mode: 0,
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [21],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
                { name: 'CLIP', type: 'CLIP', links: [22], shape: 3, slot_index: 1, label: 'CLIP' },
                { name: 'VAE', type: 'VAE', links: [28], shape: 3, label: 'VAE', slot_index: 2 },
              ],
              properties: { 'Node name for S&R': 'CheckpointLoaderSimple' },
              widgets_values: [ckpt],
            },
            {
              id: 3,
              type: 'IPAdapterModelLoader',
              pos: [181, -156],
              size: { '0': 300, '1': 60 },
              flags: {},
              order: 3,
              mode: 0,
              outputs: [
                {
                  name: 'IPADAPTER',
                  type: 'IPADAPTER',
                  links: [1],
                  shape: 3,
                  slot_index: 0,
                  label: t('IP适配'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterModelLoader' },
              widgets_values: [ip_adapter_name],
            },
            {
              id: 28,
              type: 'SaveImage',
              pos: [2436, 482],
              size: { '0': 1673.71728515625, '1': 1076.5091552734375 },
              flags: {},
              order: 24,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 74 }],
              properties: {},
              widgets_values: ['Eva_HD'],
            },
            {
              id: 9,
              type: 'KSampler',
              pos: [926, 167],
              size: { '0': 320.16607666015625, '1': 262 },
              flags: {},
              order: 20,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 7, label: t('模型') },
                { name: 'positive', type: 'CONDITIONING', link: 111, label: t('正面提示词') },
                { name: 'negative', type: 'CONDITIONING', link: 112, label: t('负面提示词') },
                { name: 'latent_image', type: 'LATENT', link: 26, label: 'Latent', slot_index: 3 },
              ],
              outputs: [
                {
                  name: 'LATENT',
                  type: 'LATENT',
                  links: [11],
                  shape: 3,
                  slot_index: 0,
                  label: 'Latent',
                },
              ],
              properties: { 'Node name for S&R': 'KSampler' },
              widgets_values: [
                input_seed,
                'randomize',
                step,
                cfg,
                sampler_name,
                'normal',
                0.9500000000000001,
              ],
            },
            {
              id: 6,
              type: 'LoadImage',
              pos: [941, 670],
              size: { '0': 453.823486328125, '1': 476.8275146484375 },
              flags: {},
              order: 4,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [3],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [style_img, 'image'],
            },
            {
              id: 8,
              type: 'CLIPTextEncode',
              pos: [650, 420],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 17,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 72, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [115],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [negative_prompt],
              color: '#322',
              bgcolor: '#533',
            },
            {
              id: 14,
              type: 'LoadImage',
              pos: [-430, 1130],
              size: { '0': 666.5375366210938, '1': 772.7017822265625 },
              flags: {},
              order: 5,
              mode: 0,
              outputs: [
                {
                  name: 'IMAGE',
                  type: 'IMAGE',
                  links: [78, 119, 122, 135, 144],
                  shape: 3,
                  slot_index: 0,
                  label: t('图像'),
                },
                { name: 'MASK', type: 'MASK', links: null, shape: 3, label: t('遮罩') },
              ],
              properties: { 'Node name for S&R': 'LoadImage' },
              widgets_values: [load_img, 'image'],
            },
            {
              id: 52,
              type: 'PreviewImage',
              pos: [319, 1129],
              size: { '0': 567.489990234375, '1': 477.95001220703125 },
              flags: {},
              order: 14,
              mode: 0,
              inputs: [{ name: 'images', type: 'IMAGE', link: 166 }],
              properties: { 'Node name for S&R': 'PreviewImage' },
            },
            {
              id: 36,
              type: 'LoraLoader',
              pos: [176, 430],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 13,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 106 },
                { name: 'clip', type: 'CLIP', link: 107 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [70], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [72, 86], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: [
                lora_name ?? 'lcm-lora-sdv1-5.safetensors',
                lora_name ? lora_strength : 0,
                lora_name ? lora_clip : 0,
              ],
            },
            {
              id: 18,
              type: 'LoraLoader',
              pos: [172, 232],
              size: { '0': 315, '1': 126 },
              flags: {},
              order: 7,
              mode: 0,
              inputs: [
                { name: 'model', type: 'MODEL', link: 21 },
                { name: 'clip', type: 'CLIP', link: 22 },
              ],
              outputs: [
                { name: 'MODEL', type: 'MODEL', links: [106], shape: 3, slot_index: 0 },
                { name: 'CLIP', type: 'CLIP', links: [107], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'LoraLoader' },
              widgets_values: ['lcm-lora-sdv1-5.safetensors', 1, 1],
            },
            {
              id: 5,
              type: 'IPAdapterApply',
              pos: [649, -79],
              size: { '0': 210, '1': 258 },
              flags: {},
              order: 16,
              mode: 0,
              inputs: [
                { name: 'ipadapter', type: 'IPADAPTER', link: 1, label: t('IP适配') },
                { name: 'clip_vision', type: 'CLIP_VISION', link: 2, label: t('CLIP视觉') },
                { name: 'image', type: 'IMAGE', link: 3, label: t('图像') },
                { name: 'model', type: 'MODEL', link: 70, label: t('模型') },
                { name: 'attn_mask', type: 'MASK', link: null },
              ],
              outputs: [
                {
                  name: 'MODEL',
                  type: 'MODEL',
                  links: [7],
                  shape: 3,
                  slot_index: 0,
                  label: t('模型'),
                },
              ],
              properties: { 'Node name for S&R': 'IPAdapterApply' },
              widgets_values: [ip_adapter_strength, 0.1, 'original', 0, 1, false],
            },
            {
              id: 7,
              type: 'CLIPTextEncode',
              pos: [650, 250],
              size: { '0': 210, '1': 120 },
              flags: {},
              order: 18,
              mode: 0,
              inputs: [{ name: 'clip', type: 'CLIP', link: 86, label: 'CLIP' }],
              outputs: [
                {
                  name: 'CONDITIONING',
                  type: 'CONDITIONING',
                  links: [114],
                  shape: 3,
                  slot_index: 0,
                  label: t('条件'),
                },
              ],
              properties: { 'Node name for S&R': 'CLIPTextEncode' },
              widgets_values: [prompt],
              color: '#232',
              bgcolor: '#353',
            },
            {
              id: 51,
              type: 'ControlNetApplyAdvanced',
              pos: [561, 737],
              size: { '0': 315, '1': 166 },
              flags: {},
              order: 19,
              mode: 0,
              inputs: [
                { name: 'positive', type: 'CONDITIONING', link: 114 },
                { name: 'negative', type: 'CONDITIONING', link: 115 },
                { name: 'control_net', type: 'CONTROL_NET', link: 108 },
                { name: 'image', type: 'IMAGE', link: 167 },
              ],
              outputs: [
                { name: 'positive', type: 'CONDITIONING', links: [111], shape: 3, slot_index: 0 },
                { name: 'negative', type: 'CONDITIONING', links: [112], shape: 3, slot_index: 1 },
              ],
              properties: { 'Node name for S&R': 'ControlNetApplyAdvanced' },
              widgets_values: [controlnet_strength, 0, controlnet_clip],
            },
            {
              id: 39,
              type: 'LineArtPreprocessor',
              pos: [-175, 911],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 8,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 78 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'LineArtPreprocessor' },
              widgets_values: ['enable', line_strength],
            },
            {
              id: 37,
              type: 'CR Upscale Image',
              pos: [1633, 181],
              size: { '0': 315, '1': 222 },
              flags: {},
              order: 23,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 73 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [74], shape: 3, slot_index: 0 },
                { name: 'show_help', type: 'STRING', links: null, shape: 3 },
              ],
              properties: { 'Node name for S&R': 'CR Upscale Image' },
              widgets_values: ['8x_eva_super.pth', 'rescale', hd, 1024, 'lanczos', 'false', 8],
            },
            {
              id: 12,
              type: 'SaveImage',
              pos: [1446, 539],
              size: { '0': 900.6381225585938, '1': 931.7376708984375 },
              flags: {},
              order: 22,
              mode: 4,
              inputs: [{ name: 'images', type: 'IMAGE', link: 13, label: t('图像') }],
              properties: {},
              widgets_values: ['Eva'],
            },
            {
              id: 54,
              type: 'Canny',
              pos: [-184, 769],
              size: { '0': 315, '1': 82 },
              flags: {},
              order: 9,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 119 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'Canny' },
              widgets_values: [0.4, 0.8],
            },
            {
              id: 55,
              type: 'M-LSDPreprocessor',
              pos: [-183, 603],
              size: { '0': 315, '1': 106 },
              flags: {},
              order: 10,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 122 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'M-LSDPreprocessor' },
              widgets_values: [0.1, 0.1, line_strength],
            },
            {
              id: 61,
              type: 'Zoe-DepthMapPreprocessor',
              pos: [-185, 480],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 11,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 135 }],
              outputs: [{ name: 'IMAGE', type: 'IMAGE', links: [], shape: 3, slot_index: 0 }],
              properties: { 'Node name for S&R': 'Zoe-DepthMapPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 63,
              type: 'OneFormer-COCO-SemSegPreprocessor',
              pos: [-181, 342],
              size: { '0': 315, '1': 58 },
              flags: {},
              order: 12,
              mode: 0,
              inputs: [{ name: 'image', type: 'IMAGE', link: 144 }],
              outputs: [
                { name: 'IMAGE', type: 'IMAGE', links: [166, 167, 168], shape: 3, slot_index: 0 },
              ],
              properties: { 'Node name for S&R': 'OneFormer-COCO-SemSegPreprocessor' },
              widgets_values: [line_strength],
            },
            {
              id: 15,
              type: 'ControlNetLoader',
              pos: [204, 752],
              size: { '0': 310, '1': 60 },
              flags: {},
              order: 6,
              mode: 0,
              outputs: [
                {
                  name: 'CONTROL_NET',
                  type: 'CONTROL_NET',
                  links: [108],
                  shape: 3,
                  slot_index: 0,
                  label: 'ControlNet',
                },
              ],
              properties: { 'Node name for S&R': 'ControlNetLoader' },
              widgets_values: [controlnet_name],
            },
          ],
          links: [
            [1, 3, 0, 5, 0, 'IPADAPTER'],
            [2, 4, 0, 5, 1, 'CLIP_VISION'],
            [3, 6, 0, 5, 2, 'IMAGE'],
            [7, 5, 0, 9, 0, 'MODEL'],
            [11, 9, 0, 11, 0, 'LATENT'],
            [13, 11, 0, 12, 0, 'IMAGE'],
            [21, 1, 0, 18, 0, 'MODEL'],
            [22, 1, 1, 18, 1, 'CLIP'],
            [26, 19, 0, 9, 3, 'LATENT'],
            [28, 1, 2, 19, 1, 'VAE'],
            [70, 36, 0, 5, 3, 'MODEL'],
            [72, 36, 1, 8, 0, 'CLIP'],
            [73, 11, 0, 37, 0, 'IMAGE'],
            [74, 37, 0, 28, 0, 'IMAGE'],
            [78, 14, 0, 39, 0, 'IMAGE'],
            [81, 40, 0, 11, 1, 'VAE'],
            [86, 36, 1, 7, 0, 'CLIP'],
            [106, 18, 0, 36, 0, 'MODEL'],
            [107, 18, 1, 36, 1, 'CLIP'],
            [108, 15, 0, 51, 2, 'CONTROL_NET'],
            [111, 51, 0, 9, 1, 'CONDITIONING'],
            [112, 51, 1, 9, 2, 'CONDITIONING'],
            [114, 7, 0, 51, 0, 'CONDITIONING'],
            [115, 8, 0, 51, 1, 'CONDITIONING'],
            [119, 14, 0, 54, 0, 'IMAGE'],
            [122, 14, 0, 55, 0, 'IMAGE'],
            [135, 14, 0, 61, 0, 'IMAGE'],
            [144, 14, 0, 63, 0, 'IMAGE'],
            [166, 63, 0, 52, 0, 'IMAGE'],
            [167, 63, 0, 51, 3, 'IMAGE'],
            [168, 63, 0, 19, 0, 'IMAGE'],
          ],
          groups: [],
          config: {},
          extra: {},
          version: 0.4,
        },
      },
    },
  };
};
